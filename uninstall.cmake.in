if(NOT EXISTS "@CMAKE_BINARY_DIR@/install_manifest.txt")
    message(FATAL_ERROR "Cannot find install manifest: @CMAKE_BINARY_DIR@/install_manifest.txt")
endif()

file(READ "@CMAKE_BINARY_DIR@/install_manifest.txt" files)
string(REGEX REPLACE "\\n" ";" files "${files}")
foreach(file ${files})
    message(STATUS "Uninstalling: ${file}")
    if(EXISTS "${file}" AND IS_SYMLINK "${file}")
        execute_process(COMMAND "@CMAKE_COMMAND@" -E remove "${file}")
    elseif(EXISTS "${file}")
        execute_process(COMMAND "@CMAKE_COMMAND@" -E remove "${file}")
    endif()
endforeach()

if(WIN32)
    set(START_MENU_SHORTCUT "$ENV{APPDATA}/Microsoft/Windows/Start Menu/Programs/@PROJECT_NAME@/@PROJECT_NAME@.lnk")
    set(START_MENU_FOLDER "$ENV{APPDATA}/Microsoft/Windows/Start Menu/Programs/@PROJECT_NAME@")
    if(EXISTS "${START_MENU_SHORTCUT}")
        file(REMOVE "${START_MENU_SHORTCUT}")
    endif()
    if(EXISTS "${START_MENU_FOLDER}")
        file(REMOVE_RECURSE "${START_MENU_FOLDER}")
    endif()
elseif(APPLE)
    set(APP_PATH "/Applications/@PROJECT_NAME@.app")
    if(EXISTS "${APP_PATH}")
        file(REMOVE_RECURSE "${APP_PATH}")
    endif()
    set(SYMLINK "/usr/local/bin/@PROJECT_NAME@")
    if(EXISTS "${SYMLINK}")
        file(REMOVE "${SYMLINK}")
    endif()
elseif(UNIX)
    set(DESKTOP_FILE "/usr/share/applications/@PROJECT_NAME@.desktop")
    if(EXISTS "${DESKTOP_FILE}")
        file(REMOVE "${DESKTOP_FILE}")
    endif()
    set(SYMLINK "/usr/local/bin/@PROJECT_NAME@")
    if(EXISTS "${SYMLINK}")
        file(REMOVE "${SYMLINK}")
    endif()
endif()
